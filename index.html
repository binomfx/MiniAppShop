<!DOCTYPE html>
<html>

<head>
	<script src="https://telegram.org/js/telegram-web-app.js"></script>
	<meta charset="UTF-8">    
	<meta name="viewport" content="width=device-width, initial-scale=1.0">    
	<title>Магазин знаний для LLM</title>
	<link rel="stylesheet" href="miniapp.css" type="text/css" media="all">
</head>
	
<body>
	<script>
		d_rubricator = {};
		fetch('rubrication.json')
			.then(response => response.json())
			.then(jsonData => {
				d_rubricator = jsonData;
		console.log("d_rubricator[1]= " + d_rubricator[1]); 
		l = Object.keys(d_rubricator).length;
		console.log("l= " + l); 
			});

		for (let i = 1; i < l; i++) {
			rubrica.append(new Option(d_rubricator[i], String(i)));
		}

		fetch('help.json')
 			.then(response => response.json())
	  		.then(jsonData => {
				let d_help = jsonData;
				document.getElementById('hlp1').innerHTML = d_help[1];
				document.getElementById('hlp2').innerHTML = d_help[2];
				document.getElementById('hlp3').innerHTML = d_help[3];
				document.getElementById('hlp4').innerHTML = d_help[4];
				document.getElementById('hlp5').innerHTML = d_help[5];
				document.getElementById('hlp6').innerHTML = d_help[6];
			}); 
		
		const tg = window.Telegram.WebApp;
		//telegramInitData = tg.initData;
		//tg.showAlert(decodeURIComponent(telegramInitData));
		tg.ready();
		tg.isExpanded;
		tg.expand();
		tg.MainButton.setText("ПОМОГИ");
		tg.MainButton.onClick(() => {     
			sendAppData();
		});
		tg.MainButton.show();


		function sendAppData() {
/*			newPrompt = "";
			if (document.getElementById('tab1').checked) { // Ручной ввод
				newPrompt = document.getElementById('prompt1').value;
			} else if (document.getElementById('tab2').checked) { // Конструктор
				s_role = document.getElementById('role').value;
				s_task = document.getElementById('task').value;
				s_task2 = document.getElementById('task2').value;
				s_format = document.getElementById('format').value;
				s_style = document.getElementById('style1').value;
				newPrompt = d_constructor[1] + s_role + d_constructor[2] + s_task + " " + s_task2 + d_constructor[3] + s_format + d_constructor[4] + s_style + d_constructor[5];
			} else if (document.getElementById('tab3').checked) { // Шаблон
				i_template = document.getElementById('template').value;
				newPrompt = d_templates[i_template];
			} else {
				tg.close();
			}
			tg.sendData(newPrompt);
*/
			tg.sendData("Данные из приложения.");
  		}
		
</script>

<!------------------------------------Вкладки (tabs)---------------------------------------->
	
<h1>Магазин знаний</h1>
<main>
  
  <input id="tab1" type="radio" name="tabs" checked>
  <label for="tab1">Главная</label>
    
  <input id="tab2" type="radio" name="tabs">
  <label for="tab2">Каталог</label>
    
  <input id="tab3" type="radio" name="tabs">
  <label for="tab3">Корзина</label>

  <input id="tab4" type="radio" name="tabs">
  <label for="tab4">Справка</label>
    
  <section id="content1">
      			<h2>Векторизованные знания из учебников и книг</h2>
	  		<p></p>
			<p>
				Новинки:
			</p>
  </section>
    
  <section id="content2">
      	<h2>Рубрики:</h2>		
	<p>
        	Выберите рубрику:<br>  
		<select id="rubrica" name="rubrica"></select>
	</p>
	<p>
		Список баз знаний:<br>
		----------------------
		<script>
			
		</script>
 	</p>
  </section>
    
  <section id="content3">
      			<h2>Корзина:</h2>
			<p></p>
  		<p>
				Список книг в корзине<br>
				----------------------
			</p>
  </section>

  <section id="content4">
      			<h2>Справка</h2>
	  		<p></p>
			<p id=hlp1></p>
			<p id=hlp2></p>
			<p id=hlp3></p>
			<p id=hlp4></p>
			<p id=hlp5></p>
			<p id=hlp6></p>
  </section>
</main>
	
</body>
</html>
